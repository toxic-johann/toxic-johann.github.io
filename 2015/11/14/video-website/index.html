<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  
  <title>抓取视频网站分享经历 | Toxic</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  
    <meta name="author" content="to-xic">
  
  
    <meta name="description" content="业务上的需求，需要引入视频网站的分享。于是小小的研究了一些视频网站。其实现在许多视频网站除了传统利于客户的分享外，也会有便于开发者的代码，不过这种代码的程度因各视频网站而不同。有的网站会提供超级棒的通用代码，没错就是iframe，如下：1&amp;lt;iframe src=&#39;http://www.tudou.com/programs/view/html5embed.action?type=2&amp;amp;c">
  
  <meta name="description" content="业务上的需求，需要引入视频网站的分享。于是小小的研究了一些视频网站。其实现在许多视频网站除了传统利于客户的分享外，也会有便于开发者的代码，不过这种代码的程度因各视频网站而不同。有的网站会提供超级棒的通用代码，没错就是iframe，如下：1&amp;lt;iframe src=&apos;http://www.tudou.com/programs/view/html5embed.action?type=2&amp;amp;c">
<meta property="og:type" content="article">
<meta property="og:title" content="抓取视频网站分享经历">
<meta property="og:url" content="http://yoursite.com/2015/11/14/video-website/index.html">
<meta property="og:site_name" content="Toxic">
<meta property="og:description" content="业务上的需求，需要引入视频网站的分享。于是小小的研究了一些视频网站。其实现在许多视频网站除了传统利于客户的分享外，也会有便于开发者的代码，不过这种代码的程度因各视频网站而不同。有的网站会提供超级棒的通用代码，没错就是iframe，如下：1&amp;lt;iframe src=&apos;http://www.tudou.com/programs/view/html5embed.action?type=2&amp;amp;c">
<meta property="og:image" content="http://7xo9s8.com1.z0.glb.clouddn.com/微信截图_20151113201451.png">
<meta property="og:updated_time" content="2015-11-14T10:24:28.559Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="抓取视频网站分享经历">
<meta name="twitter:description" content="业务上的需求，需要引入视频网站的分享。于是小小的研究了一些视频网站。其实现在许多视频网站除了传统利于客户的分享外，也会有便于开发者的代码，不过这种代码的程度因各视频网站而不同。有的网站会提供超级棒的通用代码，没错就是iframe，如下：1&amp;lt;iframe src=&apos;http://www.tudou.com/programs/view/html5embed.action?type=2&amp;amp;c">
  
    <link rel="alternate" href="/atom.xml" title="Toxic" type="application/atom+xml">
  
  
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
  
<script type="text/javascript">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?9d865e87f3199160311b03cd56126f47";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();

</script>

</head>

<body>
  <div class="wrapper">
    <header id="header">
  <div class="title">
    <h1><a href="/">Toxic</a></h1>
    <p><a href="/">李猜猜，被折磨得死去活来的菜鸟</a></p>
  </div>
  <nav class="nav">
    <ul>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/archives">Archives</a></li>
      
        <li><a href="/about">About</a></li>
      
      
        <li><a href="/atom.xml">RSS</a></li>
      
    </ul>
    <div class="clearfix"></div>
  </nav>
  <div class="clearfix"></div>
</header>
    <div class="content"><article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/11/14/video-website/">
  <time datetime="2015-11-14T09:25:29.000Z">
    2015-11-14
  </time>
</a>
    
    
  
    <h1 class="title">抓取视频网站分享经历</h1>
  

  </header>
  
  <div class="entry">
    
      <p>业务上的需求，需要引入视频网站的分享。于是小小的研究了一些视频网站。其实现在许多视频网站除了传统利于客户的分享外，也会有便于开发者的代码，不过这种代码的程度因各视频网站而不同。有的网站会提供超级棒的通用代码，没错就是iframe，如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe src=<span class="string">'http://www.tudou.com/programs/view/html5embed.action?type=2&amp;code=gHh8ZOXj5pg.html&amp;lcode=92J2xqpSxWY&amp;resourceId=0_06_05_99'</span> allowtransparency=<span class="string">'true'</span> allowfullscreen=<span class="string">'true'</span> allowfullscreenInteractive=<span class="string">'true'</span> scrolling=<span class="string">'no'</span> border=<span class="string">'0'</span> frameborder=<span class="string">'0'</span> style=<span class="string">'width:480px;height:400px;'</span>&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure></p>
<p>这种通用代码在很多浏览器上面都是支持的，直接引用就可以。</p>
<p>而稍微不友好一点的网站呢，则会提供用embed包装的html代码。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;object width=<span class="number">1460</span> height=<span class="number">880</span>&gt;&lt;param name=<span class="string">"movie"</span> value=<span class="string">"http://share.vrs.sohu.com/2697007/v.swf&amp;topBar=1&amp;autoplay=false&amp;plid=9063689&amp;pub_catecode=122102&amp;from=page"</span>&gt;&lt;/param&gt;&lt;param name=<span class="string">"allowFullScreen"</span> value=<span class="string">"true"</span>&gt;&lt;/param&gt;&lt;param name=<span class="string">"allowscriptaccess"</span> value=<span class="string">"always"</span>&gt;&lt;/param&gt;&lt;param name=<span class="string">"wmode"</span> value=<span class="string">"Transparent"</span>&gt;&lt;/param&gt;&lt;embed width=<span class="number">1460</span> height=<span class="number">880</span> wmode=<span class="string">"Transparent"</span> allowfullscreen=<span class="string">"true"</span> allowscriptaccess=<span class="string">"always"</span> quality=<span class="string">"high"</span> src=<span class="string">"http://share.vrs.sohu.com/2697007/v.swf&amp;topBar=1&amp;autoplay=false&amp;plid=9063689&amp;pub_catecode=122102&amp;from=page"</span> <span class="built_in">type</span>=<span class="string">"application/x-shockwave-flash"</span>/&gt;&lt;/embed&gt;&lt;/object&gt;</span><br></pre></td></tr></table></figure></p>
<p>这种html代码在市面上大部分浏览器上可以播的，但是可惜的是，手机上不可以。而这也造成了众多的不便。因为我要生成的页面会在手机上。</p>
<p>更有甚者，直接提供一个flash源。辣真是歪日了=-=，手机不能放flash啊。</p>
<p>OK，那么我们这个时候只能采取调用手机调试的方式，获取其手机上的video标签，观察他的video标签就可以了。</p>
<p>本次业务的目标，是通过播放页的url直接引入通用代码。那么也不是难事，如果有通用代码就引入通用代码，如果没有，我就给他写一个。</p>
<p>困难的点在于，并不是每个网站都会仁慈地把vid放在url上。<br>现在咱们来梳理一下。</p>
<p>youku</p>
<p>真是一个友好到爆的视频网站，直接提过iframe代码不说，而且iframe是根据vid来进行获取的。视频源我没有探索，因为不需要。</p>
<p>而这个vid则直接写在了url上。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://v.youku.com/v_show/id_XNTY0MzE4NTE2.html?from=y1.<span class="number">3</span>-idx-uhome-<span class="number">1519</span>-<span class="number">20887.212790</span>-<span class="number">212949.1</span>-<span class="number">1.1</span>-<span class="number">8</span>-<span class="number">1</span>-<span class="number">1</span>-<span class="number">0</span><span class="comment">#paction</span></span><br></pre></td></tr></table></figure></p>
<p>请看上图的这个id_<strong><strong><em>*</em></strong></strong>.html。就是大家想要的id，我只需要将其替换就可以了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe height=<span class="number">498</span> width=<span class="number">510</span> src=<span class="string">'http://player.youku.com/embed/XNTY0MzE4NTE2'</span> frameborder=<span class="number">0</span> allowfullscreen&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>
<p>tudou<br>也是一个十分友好的网站，提供了iframe。页面url和iframe拥有直接的关系。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.tudou.com/albumplay/<span class="number">92</span>J2xqpSxWY/gHh8ZOXj5pg.html</span><br></pre></td></tr></table></figure>
<p>在albumplay后面的是lcode，再后一格的是code。只需要进行拼接，就可以获得分享的代码。<br>当然有的时候lcode不是必须的。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.tudou.com/programs/view/EfLFVsQ486o/</span><br></pre></td></tr></table></figure>
<p>比如在这种url中，我们直接把lcode置位空即可。</p>
<p>细心的你还会发现这种url<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.tudou.com/listplay/Yxxcbtz1rQ0/LAsexrGoJ7c.html</span><br></pre></td></tr></table></figure></p>
<p>没错，拥有的是listplay。而这三种代码的不同之处，就是他们的type变量是不一样的。分别为2、0、1。大家可以尝试一下啊。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe src=<span class="string">'http://www.tudou.com/programs/view/html5embed.action?type=2&amp;code=gHh8ZOXj5pg.html&amp;lcode=92J2xqpSxWY&amp;resourceId=0_06_05_99'</span> allowtransparency=<span class="string">'true'</span> allowfullscreen=<span class="string">'true'</span> allowfullscreenInteractive=<span class="string">'true'</span> scrolling=<span class="string">'no'</span> border=<span class="string">'0'</span> frameborder=<span class="string">'0'</span> style=<span class="string">'width:480px;height:400px;'</span>&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure></p>
<p>腾讯视频</p>
<p>腾讯视频也是一个很友好的视频网站，基本上都提供了通用代码。但是估计是考虑到版权的问题。有一些有版权的视频，他们的播放页url是经过一定的加密的。例如这种：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://v.qq.com/cover/<span class="number">2</span>/<span class="number">2</span>fcm0ffmcs4ltvu.html</span><br></pre></td></tr></table></figure></p>
<p>当然，有其他的是没有加密的，<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://v.qq.com/cover/q/qnj1lyl17r2vz5i.html?vid=z0018mfqzbo</span><br></pre></td></tr></table></figure></p>
<p>vid=多少，清楚明白，替换即可。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe frameborder=<span class="string">"0"</span> width=<span class="string">"640"</span> height=<span class="string">"498"</span> src=<span class="string">'http://v.qq.com/iframe/player.html?vid=z0018mfqzbo&amp;tiny=0&amp;auto=0'</span> allowfullscreen&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure></p>
<p>新浪视频</p>
<p>这个我就有点醉了。不提供通用代码，不过这也不是难事。我只需要打开手机调试，看看他的video标签就可以了。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;video id=<span class="string">"myMovie"</span> src=<span class="string">'http://v.iask.com/v_play_ipad.php?vid=139215368&amp;amp;tags=newsList_web&amp;amp;time=1447494598240&amp;amp;rd=0.958624585531652'</span> controls=<span class="string">""</span> autoplay=<span class="string">""</span> preload=<span class="string">"auto"</span> style=<span class="string">"width: 640px; height: 516px;"</span> poster=<span class="string">""</span>&gt;&lt;/video&gt;</span><br></pre></td></tr></table></figure></p>
<p>恩呢，这个vid真是棒棒的，然后问题就来了。在很多页面，这个vid和url串上的数字没有啥关系。鉴于我不是解密大师，我暂且放弃了这个功能。</p>
<p>ku6</p>
<p>酷6现在应该不算出名吧，所以，他也没有提供通用代码。然后老方法，拿到了video标签。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;video preload=<span class="string">"meta"</span> src=<span class="string">'http://v.ku6.com/fetchwebm/8VHjSp3_PGA2-3pT40ut5Q...m3u8'</span> controls=<span class="string">""</span> poster=<span class="string">'http://vi0.ku6img.com/data1/p16/ku6video/2015/11/13/13/1452946133184_152038688_152038688/107.jpg'</span> style=<span class="string">"margin: 0px; padding: 0px; width: 100%; height: 100%; z-index: 1; background-color: black;"</span>&gt;浏览器不支持HTML5视频&lt;br&gt;you browser DO NOT support HTML5 video&lt;br&gt;&lt;img id=<span class="string">"KP_vposter"</span> src=<span class="string">'http://vi0.ku6img.com/data1/p16/ku6video/2015/11/13/13/1452946133184_152038688_152038688/107.jpg'</span>&gt;&lt;/video&gt;</span><br></pre></td></tr></table></figure></p>
<p>棒棒的，这个m3u8文件大家都看到了吧，然后他的id还和url的id串一模一样，轻松生成通用代码。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://v.ku6.com/show/<span class="number">8</span>VHjSp3_PGA2-<span class="number">3</span>pT40ut5Q...html</span><br></pre></td></tr></table></figure></p>
<p>sohu</p>
<p>sohu应该是我比较喜欢的一个视频网站，以前看美剧什么的都在上面看。不过他也没有通用代码。而且，sohu的情况就有点特殊。有一个十分好的版权保护策略。涉及版权的视频播放页url加密处理。这种情况一般都是tv.sohu的策略。而网友分享的视频，播放页url也是和id对应的。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://my.tv.sohu.com/pl/<span class="number">8397747</span>/<span class="number">82100134</span>.shtml</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe height=<span class="number">498</span> width=<span class="number">510</span> src=<span class="string">'http://tv.sohu.com/upload/static/share/share_play.html#82100134_8397747_0_9001_0'</span> frameborder=<span class="number">0</span> allowfullscreen&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>
<p>又是一次轻松获取。两个code进行一次互换即可。有人可能会问code后面那一串数字是啥。其实那个是清晰度。有人问，为啥没有分享代码，但是你还会用iframe呢？马上揭晓为何。</p>
<p>56网</p>
<p>悲催的56，已经被搜狐收购了。其实我是不知道的，直到我发现他棒棒的通用代码，是sohu的url。醉了。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe src=<span class="string">'http://tv.sohu.com/upload/static/share/share_play.html#82080385_8410600_0_9001_0'</span> width=<span class="string">"320"</span> height=<span class="string">"270"</span> frameborder=<span class="string">"0"</span> allowfullscreen=<span class="string">""</span>&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure></p>
<p>于是我也不关心他俩的url了，因为真的没法弄了。不过幸运的是，我就此拿到了搜狐网站的通用代码。真是棒棒哒。</p>
<p>爱奇艺</p>
<p>前不久才崛起的一个视频网站。棒棒的有分享代码。不过页面url有加密。和vid没啥关系。放弃，直接贴通用代码吧。</p>
<p>凤凰网</p>
<p>没有通用代码，于是拷下来了通用代码，不过也没有啥卵用，页面url是加密过的。</p>
<p>音悦台</p>
<p>好多歌，真是棒棒的。所以估计版权问题时挺严重的。没有通用代码。找video标签，很兴奋的看到了url中的字串和videoID一样。结果，这个videoID不是决定性因素。暂且放弃。</p>
<p>letv<br>与音悦台一样，vid不是决定性因素。</p>
<p>另外，谈一些有趣的发现。</p>
<p><img src="http://7xo9s8.com1.z0.glb.clouddn.com/微信截图_20151113201451.png" alt=""></p>
<p>没错，如你所见，爱奇艺在打log。</p>
<p>另外，不是说在手机端找到video标签嘛=-=<br>video标签的src是干嘛用呢。对的，引入视频。如果没有做限制的话，那个就是你们想要的视频源地址。直接点开，下载吧……在某些网站真的可用。</p>

    
  </div>
  <footer>
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


<section id="comment">
  <h1 class="title">评论</h1>
  <div class="ds-thread" data-title="抓取视频网站分享经历">
  </div>
</section>
</div>
  </div>
  <footer id="footer"><div class="copyright">
  
  &copy; 2016 <a href="/">to-xic</a>
  
</div>
<div class="theme-copyright">
  Theme by <a href="https://github.com/orderedlist" target="_blank">orderedlist</a>
   | 
  Redesign by <a href="http://heroicyang.com/" target="_blank">Heroic Yang</a>
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
<script src="/js/scale.fix.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
  var duoshuoQuery = { short_name: 'toxicjohann' };
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';
    ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
  (function($){
    $('.fancybox').fancybox();
  })(jQuery);
</script>

</body>
</html>